"use strict";define("page/partner-application",["jquery","common/calendar","log","jquery.cookie"],function(t,e,r){function a(){var e=t(".select-wrap");e.removeClass("spread"),e.addClass("folder")}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t=t.parent(),t.hasClass("folder")?(a(),t.removeClass("folder"),e?setTimeout(function(){t.addClass("spread")},e):t.addClass("spread")):(t.removeClass("spread"),t.addClass("folder"))}function n(e,r,a){e.addClass("completed"),e.text(r),t(".check-error."+a).hide()}function o(e){var a=e.text(),o=e.parent().data("type"),c=e.parent().data("log"),d=e.parent().data("ch"),s=e.data("bool"),l=e.data("fr"),u=t(".js-select-"+o).find(".text");""!==s&&u.data("select",s),"province"===o&&F.find(".text").text("请选择城市"),l&&"introducer"===l&&J.show(),l&&"other"===l&&J.hide(),!c&&d&&(r.push(["_trackEvent","copartner-detailpage_information_input","submit","","",{value:d}]),e.parent().data("log",!0)),n(u,a,o),i(t(".js-select-"+o))}function c(){new e({el:".js-option-calendar",clickCb:function(t,e,a){var o=t+"-"+e+"-"+a,c=N.find(".text"),d=N.data("log"),s=N.data("ch");d||(r.push(["_trackEvent","copartner-detailpage_information_input","submit","","",{value:s}]),N.data("log",!0)),n(c,o,"join"),i(N)},upDate:(new Date).getFullYear()+1+", 11",noPrevDate:!0})}function d(e,r){return!!e&&(M=!0,void t.getJSON("/index.php?c=citylist&m=get_city_by_province&d=api&province="+encodeURIComponent(e),function(t){0===t.status&&t.cities&&r&&r(t.cities)}))}function s(e){if(e){"[object Array]"!==Object.prototype.toString.call(e)&&(e=[].concat(e));var r=t(".js-option-city"),a="";e.forEach(function(t){a+='<li class="item">'+t+"</li>"}),r.html(a),r.find(".item").on("click",function(){o(t(this))})}}function l(){var e=t(".js-option-province"),r=[],a="";r.push('<header class="option-title">请选择</header>'),Object.keys(X).forEach(function(t){a+='<h3 class="letter">'+t+'</h3>\n                         <ul class="provice-list js-option" data-type="province">',X[t].forEach(function(t){a+='<li class="item" data-name="'+t.data+'" data-redirect="'+t.redirect+'">'+t.data+"</li>"}),a+="</ul>"}),r.push(a),e.html(r.join("")),e.find(".item").on("click",function(){var e=t(this).data("name");""===t(this).data("redirect")?d(e,s):(s(e,!0),M=!0)})}function u(e){var r=e.attr,a=e.type,i=e.err,n=e.def,o=e.reg,c=e.regErr,d=void 0,s=t(".check-error."+a);return r===n?(s.text(i).show(),d=!1):o&&!o.test(r)?(s.text(c).show(),d=!1):(s.hide(),d=!0),d}function p(){var e={},r=q.val(),a=D.find(".text").text(),i=F.find(".text").text(),n=N.find(".text").text(),o=P.val(),c=R.find(".text").data("select"),d=A.find(".text").data("select"),s=H.find(".text").text(),l=z.val(),p=B.val(),f=[{type:"name",attr:r,err:"请输入姓名",bool:!1,def:"",reg:/^[^0-9]{1,5}$/,regErr:"请输入正确的姓名(1-5个字符，不包含数字)"},{type:"province",attr:a,err:"请选择省份",bool:!1,def:"请选择省份"},{type:"city",attr:i,err:"请选择城市",bool:!1,def:"请选择城市"},{type:"join",attr:n,err:"请选择最快加盟时间",bool:!1,def:"请选择最快加盟时间"}];f.forEach(function(t){t.bool=u(t),t.bool&&(e[t.type]=t.attr)});var h=[{type:"address",attr:o,def:"",reg:/^.{1,30}$/,regErr:"字数不应超过30字",bool:!0},{type:"industry",attr:c,def:"",bool:!0},{type:"shop",attr:d,def:"",bool:!0},{type:"channel",attr:s,def:"请选择",bool:!0},{type:"recom_info",attr:l,def:"",reg:/^.{1,20}$/,regErr:"字数不应超过20字",bool:!0},{type:"remark",attr:p,def:"",reg:/^.{1,300}$/,regErr:"字数不应超过300字",bool:!0}];return h.forEach(function(r){r.attr!==r.def&&(r.reg&&!r.reg.test(r.attr)?(r.bool=!1,t(".check-error."+r.type).text(r.regErr).show()):e[r.type]=r.attr)}),f.every(function(t){return t.bool})&&h.every(function(t){return t.bool})&&e}function f(){var e=[q,P,z,B];e.forEach(function(t){t.val(""),t.data("log",!1)});var r=[{ele:D,text:"请选择省份"},{ele:F,text:"请选择城市"},{ele:N,text:"请选择最快加盟时间"},{ele:R,text:"请选择"},{ele:A,text:"请选择"},{ele:H,text:"请选择"}];r.forEach(function(e){e.ele.find(".text").text(e.text),e.ele.find(".text").removeClass("completed"),e.ele.find(".text").data("select",""),t(".js-option").data("log",!1),t(".js-select-calendar").data("log",!1)}),t(".js-option-city").html(""),M=!1,t(".check-error").text("").hide(),J.hide()}function h(e,a){Object.assign(e,Q,{intent_type:"rrc-openapi-partner",device:"",origin:""}),t.ajax({type:"POST",url:U+"/intent/ark/v1/intent/partner/extra",data:e,success:function(t){var i=t.status,n=t.errmsg;if(0===i)a&&a(),r.push(["_trackEvent","copartner-detailpage_information-result_popup","submit","","",{value:"成功"}]);else if(200===i){var o=t.msg,c=o.image,d=o.status_v2;w.attr("src",c),Z(),d&&"401"===d&&W("验证码错误"),x.off("click"),x.on("click",function(){h(e)})}else K(),W(n),r.push(["_trackEvent","copartner-detailpage_information-result_popup","submit","","",{value:"失败"}])},error:function(){W("请稍后再试"),r.push(["_trackEvent","copartner-detailpage_information-result_popup","submit","","",{value:"失败"}])}})}function v(){var t=window.innerHeight;t<=790?S.css("height",.95*t+"px"):S.css("height","auto")}function m(){t("body").bind("login",function(){Y()}),t(window).resize(function(){v()}),E.click(function(){t(".code-input").val(""),_.hide(),b.hide()}),C.click(function(){_.hide(),y.hide()}),j.click(function(){k.play(),j.hide()}),t(".partner-input").on("input",function(){tt()}),T.on("click",function(){var e=t(".partner-input").val(),a=t(".code-input").val(),i=/^1[0-9]{10}$/;if(e)if(i.test(e)){var n={phone:e,code:a||""};et(n,function(){t(".code-input").val(""),b.hide(),v(),_.show(),S.show(),r.push(["_trackEvent","合伙人招商补充信息页","rrc-pageModule-show"])}),r.push(["_trackEvent","copartnerpage_phone-submit_click","click"])}else W("请输入正确的手机号");else W("请输入手机号")}),t(".js-input").focus(function(){a()}),t(".js-input").on("input",function(){var e=t(this).data("log"),a=t(this).data("ch");!e&&a&&(r.push(["_trackEvent","copartner-detailpage_information_input","submit","","",{value:a}]),e=t(this).data("log",!0))}),t(".js-input").on("input",function(){var e=t(this).data("field");t(".check-error."+e).text("").hide()}),t(".js-select").click(function(){t(this).hasClass("js-select-city")?M?i(t(this),100):W("请先选择省份"):i(t(this))}),t(".js-option .item").on("click",function(){o(t(this))}),$.click(function(){S.hide(),_.hide(),f()}),I.click(function(){var t=p();t&&(h(t,function(){S.hide(),G.show(),f()}),r.push(["_trackEvent","copartner-detailpage_information-submit_click","click"]))}),L.click(function(){G.hide(),_.hide()})}function g(){Y(),c(),l(),m()}var k=document.querySelector("#video-service-h5"),j=t("#js-play"),_=t(".popup-mask"),y=t(".popup-success"),b=t(".popup-wrap"),x=t(".js-codeimg"),w=t(".js-codeimg .img"),E=t(".close-icon"),C=t(".js-success-close"),T=t(".js-submit-btn"),O=t(".alert"),S=t(".js-partner-add"),$=t(".js-partner-add-close"),q=t(".js-input-name"),P=t(".js-input-address"),D=t(".js-select-province"),F=t(".js-select-city"),N=t(".js-select-calendar"),R=t(".js-select-industry"),A=t(".js-select-shop"),H=t(".js-select-channel"),J=t(".js-introducer-info"),z=t(".js-input-intro"),B=t(".js-input-remark"),G=t(".js-partner-add-success"),I=t(".js-add-submit"),L=t(".js-return-btn"),M=!1,Q={},U="https://ark.renrenche.com",X={A:[{data:"澳门",redirect:"not"},{data:"安徽",redirect:""}],B:[{data:"北京",redirect:"not"}],C:[{data:"重庆",redirect:"not"}],F:[{data:"福建",redirect:""}],G:[{data:"甘肃",redirect:""},{data:"贵州",redirect:""},{data:"广东",redirect:""},{data:"广西",redirect:""}],H:[{data:"海南",redirect:""},{data:"河北",redirect:""},{data:"河南",redirect:""},{data:"湖北",redirect:""},{data:"湖南",redirect:""},{data:"黑龙江",redirect:""}],J:[{data:"吉林",redirect:""},{data:"江苏",redirect:""},{data:"江西",redirect:""}],L:[{data:"辽宁",redirect:""}],N:[{data:"宁夏",redirect:""},{data:"内蒙古",redirect:""}],Q:[{data:"青海",redirect:""}],S:[{data:"上海",redirect:"not"},{data:"四川",redirect:""},{data:"山东",redirect:""},{data:"山西",redirect:""},{data:"陕西",redirect:""}],T:[{data:"天津",redirect:"not"}],X:[{data:"新疆",redirect:""},{data:"西藏",redirect:""},{data:"香港",redirect:"not"}],Z:[{data:"浙江",redirect:""}]},Y=function(){var e=t.cookie("rrc_intent_phone")||t.cookie("rrc_login_phone")||"";t(".partner-input").val(e)},Z=function(){t(".code-input").val(""),_.show(),b.show()},K=function(){_.hide(),b.hide()},V=void 0,W=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500;O.html(t).show(),V&&clearTimeout(V),V=setTimeout(function(){O.hide()},e)},tt=function(){V&&(clearTimeout(V),O.html("").hide())},et=function rt(e,r){var a=e.phone,i=e.code;t.ajax({type:"POST",url:U+"/intent/ark/v1/intent/partner/add",xhrFields:{withCredentials:!0},data:{city:RRC.cityName,verify_code:i,phone:a,source:"hehuoren_website1",submit_source:"合伙人招商页1-立即报名-底部悬浮",intent_type:"rrc-openapi-partner",device:"PC",uuid:t.cookie("new_visitor_uuid")||"",origin:""},success:function(t){var e=t.status,i=t.errmsg;if(0===e)Q={phone:t.data.phone,token:t.data.token},r&&r();else if(200===e){var n=t.msg,o=n.image,c=n.status_v2;w.attr("src",o),Z(),c&&"401"===c&&W("验证码错误"),x.off("click"),x.on("click",function(){rt({phone:a,code:""})})}else 301===e?(K(),W(i,5e3)):(K(),W(i))},error:function(){W("请稍后再试")}})};return{init:g}}),"undefined"==typeof window.__karma__&&require(["page/partner-application"],function(t){t.init()});
//# sourceMappingURL=partner-application-dbc28653.js.map
